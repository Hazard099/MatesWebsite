<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Scientist Migration Database</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .about-section {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .about-section h3 {
            color: #003366;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .about-section p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .about-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        .about-item h4 {
            color: #0066cc;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .about-item p {
            margin-bottom: 0;
            font-size: 14px;
        }

        .disclaimer {
            background: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #0066cc;
            font-size: 13px;
            color: #666;
            border-radius: 0 4px 4px 0;
        }

        @media (max-width: 768px) {
            .about-grid {
                grid-template-columns: 1fr;
            }
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.4;
            color: #333;
            background-color: #f8f9fa;
        }

        .header {
            background-color: #ffffff;
            border-bottom: 3px solid #0066cc;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: bold;
            color: #003366;
            margin-bottom: 8px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .stats-bar {
            background: white;
            border: 1px solid #ddd;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .stats-row {
            display: flex;
            gap: 40px;
            align-items: center;
            font-size: 14px;
        }

        .stat-item {
            color: #666;
        }

        .stat-number {
            font-weight: bold;
            color: #0066cc;
        }

        .controls {
            background: white;
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .controls-row {
            display: grid;
            grid-template-columns: 2fr auto auto auto;
            gap: 15px;
            align-items: center;
            width: 100%;
        }

        .search-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-group label {
            font-size: 14px;
            color: #333;
            font-weight: normal;
            white-space: nowrap;
        }

        .search-group input, .search-group select {
            padding: 6px 8px;
            max-width: 300px;
            border: 1px solid #ccc;
            font-size: 14px;
            border-radius: 3px;
            background: white;
        }

        .search-group input {
            width: 250px;
        }

        .search-group select {
            min-width: 150px;
        }

        .btn {
            padding: 8px 16px;
            font-size: 14px;
            border: 1px solid #0066cc;
            background: #0066cc;
            color: white;
            border-radius: 3px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #0052a3;
        }

        .btn-secondary {
            background: white;
            color: #0066cc;
        }

        .btn-secondary:hover {
            background: #f0f7ff;
        }

        .table-container {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }

        .table-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            font-size: 14px;
            font-weight: bold;
            color: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .results-info {
            font-size: 13px;
            color: #666;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: #f1f3f4;
            padding: 12px 15px;
            text-align: left;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
        }

        th:hover {
            background: #e8f0fe;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            vertical-align: top;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .scientist-name {
            font-weight: bold;
            color: #0066cc;
        }

        .institution {
            color: #333;
        }

        .institution-line1 {
            font-weight: bold;
            color: #333;
        }

        .institution-line2 {
            font-size: 12px;
            color: #666;
            font-style: italic;
            margin-top: 2px;
        }

        .specialization {
            color: #666;
            font-style: italic;
        }

        .destination {
            color: #d73527;
            font-weight: 500;
        }

        .linkedin-link {
            color: #0066cc;
            text-decoration: none;
        }

        .linkedin-link:hover {
            text-decoration: underline;
        }

        .no-data {
            padding: 40px;
            text-align: center;
            color: #666;
            font-style: italic;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 3% auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #ddd;
        }

        .modal-header h2 {
            font-size: 18px;
            color: #333;
            margin: 0;
        }

        .modal-body {
            padding: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
            font-size: 14px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 14px;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #0066cc;
        }

        .required {
            color: #d73527;
        }

        .modal-footer {
            background: #f8f9fa;
            padding: 15px 20px;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .close {
            color: #999;
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            color: #333;
        }

        .sort-icon {
            margin-left: 5px;
            color: #999;
            font-size: 10px;
        }

        .sort-icon.active {
            color: #0066cc;
            font-weight: bold;
        }

        .export-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            color: #666;
        }

        .export-btn {
            background: #28a745;
            border-color: #28a745;
            margin-left: 10px;
        }

        .export-btn:hover {
            background: #218838;
            border-color: #1e7e34;
        }

        .home-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .home-button a {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-family: Arial, sans-serif;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .home-button a:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        @media (max-width: 768px) {
            .controls-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .search-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .search-group input {
                width: 100%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="home-button">
        <a href="index.html">Who am I?</a>
    </div>
    
    <div class="header">
        <div class="header-content">
            <h1>US Scientist Migration Database</h1>
            <p>Tracking scientific talent migration from US research institutions to international positions</p>
        </div>
    </div>
        <div class="container">
            <div class="stats-bar">
                <div class="stats-row">
                    <div class="stat-item">
                        Total Scientists: <span class="stat-number" id="totalScientists">Loading...</span>
                    </div>
                    <div class="stat-item">
                        Top Destination: <span class="stat-number" id="topDestination">Loading...</span>
                    </div>  
                    <div class="stat-item">
                        Destination Countries: <span class="stat-number" id="uniqueDestinations">Loading...</span>
                    </div>
                    <div class="stat-item">
                        Last Updated: <span class="stat-number">September 2025</span>
            </div>
        </div>
    </div>

        <div class="controls">
            <div class="controls-row">
                <div class="search-group">
                    <label>Search:</label>
                    <input type="text" id="searchInput" placeholder="Name, institution, specialization...">
                </div>
                <div class="search-group">
                    <label>Filter by Specialty:</label>
                    <select id="specialtyFilter">
                        <option value="">All Specialties</option>
                    </select>
                </div>
                <div class="search-group">
                    <label>Destination:</label>
                    <select id="destinationFilter">
                        <option value="">All Countries</option>
                    </select>
                </div>
                <a href="https://forms.gle/7bB6D5sxEXT1VyHSA" target="_blank" class="btn">Submit New Entry</a>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <span>Search Results</span>
                <span class="results-info" id="resultsInfo">Loading...</span>
            </div>
            <table id="scientistsTable">
                <thead>
                    <tr>
                        <th onclick="sortTable(0, 'name')">Name <span class="sort-icon">▲▼</span></th>
                        <th onclick="sortTable(1, 'previousInstitution')">Previous Institution <span class="sort-icon">▲▼</span></th>
                        <th onclick="sortTable(2, 'specialization')">Specialization <span class="sort-icon">▲▼</span></th>
                        <th onclick="sortTable(3, 'destination')">Destination <span class="sort-icon">▲▼</span></th>
                        <th onclick="sortTable(4, 'newInstitution')">New Institution <span class="sort-icon">▲▼</span></th>
                        <th>Profile Link</th>
                    </tr>
                </thead>
                <tbody id="scientistsTableBody">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="export-section">
            <strong>Data Export:</strong> 
            <button class="btn export-btn" onclick="exportToCSV()">Export to CSV</button>
            <button class="btn export-btn" onclick="exportToJSON()">Export to JSON</button>
            <span style="margin-left: 15px; color: #666;">Last database update: September 5, 2025</span>
        </div>

        <div class="about-section">
            <h3>About This Database</h3>
            <p>This database tracks the migration of scientific talent from US research institutions to international positions. It is maintained as a community-sourced project to provide transparency into the movement of researchers and academics.</p>
            
            <div class="about-grid">
                <div class="about-item">
                    <h4>Data Sources</h4>
                    <p>All entries are based on publicly available information from institutional announcements, LinkedIn profiles, news articles, and community submissions.</p>
                </div>
                
                <div class="about-item">
                    <h4>How to Contribute</h4>
                    <p>Know of a scientist who has migrated? Submit their information using our form. All submissions are reviewed before publication to ensure accuracy.</p>
                </div>
                
                <div class="about-item">
                    <h4>Contact & Corrections</h4>
                    <p>For corrections, removals, or questions, please contact us. If you are listed and prefer not to be included, we will promptly remove your entry.</p>
                </div>
            </div>
            
            <div class="disclaimer">
                <strong>Disclaimer:</strong> This database is for informational and research purposes only. All information is sourced from publicly available materials. We respect privacy and will remove entries upon request.
            </div>
        </div>
        </div>
    </div>

    <script>
        let allScientists = [
            // ETH Zurich cluster (6 scientists)
            {
                name: "Prof. Sarbajit Banerjee",
                previousInstitution: "Texas A&M University",
                specialization: "Battery Materials & Electrochemical Energy Storage",
                destination: "Switzerland",
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Professor of Battery Materials, Department of Chemistry and Applied Biosciences",
                linkedin: "https://ethz.ch/en/the-eth-zurich/organisation/who-is-who/bsse/"
            },
            {
                name: "Prof. Michele Vallisneri",
                previousInstitution: "NASA Jet Propulsion Laboratory / Caltech",
                specialization: "Gravitational-Wave Astrophysics",
                destination: "Switzerland",
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Professor of Gravitational Physics, Department of Physics",
                linkedin: "https://ethz.ch/en/the-eth-zurich/organisation/who-is-who/"
            },
            {
                name: "Dr. Melissa Chapman",
                previousInstitution: "UC Santa Barbara (NCEAS)",
                specialization: "Environmental Data Science & Biodiversity",
                destination: "Switzerland",
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Assistant Professor of Environmental Policy, Department of Environmental Systems Science",
                linkedin: "https://ethz.ch/en/the-eth-zurich/organisation/who-is-who/"
            },
            {
                name: "Dr. Michael Moor",
                previousInstitution: "Stanford University",
                specialization: "Medical AI & Biomedical Data Science",
                destination: "Switzerland",
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Assistant Professor of Medical AI, Department of Biosystems Science and Engineering",
                linkedin: "https://ethz.ch/en/the-eth-zurich/organisation/who-is-who/bsse/details.MjQ0MDY1.TGlzdC8xOTA2LC03MDcyMjgwNTA=.html"
            },
            {
                name: "Dr. Sascha Feldmann",
                previousInstitution: "Harvard University",
                specialization: "Semiconductor Optoelectronics & Hybrid Perovskites",
                destination: "Switzerland",
                newInstitution: "EPFL",
                newInstitutionDetails: "Assistant Professor of Physical Chemistry, EPFL Valais Wallis",
                linkedin: "https://www.epfl.ch/labs/"
            },
            {
                name: "Prof. Ryan Cotterell",
                previousInstitution: "Johns Hopkins University",
                specialization: "Natural Language Processing & Computational Linguistics",
                destination: "Switzerland",
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Professor of Computer Science, Department of Computer Science",
                linkedin: "https://rycolab.io/"
            },

            // University of Toronto cluster (4 scientists)
            {
                name: "Dr. Aviad Levis",
                previousInstitution: "California Institute of Technology",
                specialization: "Computational Imaging & AI for Scientific Discovery",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Assistant Professor, Department of Computer Science",
                linkedin: "https://www.aviadlevis.info"
            },
            {
                name: "Dr. Roei Tell",
                previousInstitution: "Massachusetts Institute of Technology",
                specialization: "Theoretical Computer Science & Computational Complexity",
                destination: "Canada",
                newInstitution: "University of Toronto Scarborough",
                newInstitutionDetails: "Assistant Professor, Department of Computer and Mathematical Sciences",
                linkedin: "https://www.cs.toronto.edu/~roei/"
            },
            {
                name: "Dr. Paul He",
                previousInstitution: "University of Pennsylvania",
                specialization: "Programming Language Theory & Computer Science Education",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Assistant Professor, Teaching Stream, Department of Computer Science",
                linkedin: "https://web.cs.toronto.edu/"
            },
            {
                name: "Dr. Victor Couture",
                previousInstitution: "UC Berkeley Haas School of Business",
                specialization: "Urban Economics & Data Science Applications",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Associate Professor, Rotman School of Management",
                linkedin: "https://www.rotman.utoronto.ca/"
            },

            // Max Planck Institutes (3 scientists)
            {
                name: "Prof. Amélie Saintonge",
                previousInstitution: "University College London (originally Cornell)",
                specialization: "Galaxy Evolution & Star Formation",
                destination: "Germany",
                newInstitution: "Max Planck Institute for Radio Astronomy",
                newInstitutionDetails: "Director, Bonn",
                linkedin: "https://www.mpifr-bonn.mpg.de/"
            },
            {
                name: "Prof. Yafang Cheng",
                previousInstitution: "University of Iowa",
                specialization: "Atmospheric Aerosols & Climate Impacts",
                destination: "Germany",
                newInstitution: "Max Planck Institute for Chemistry",
                newInstitutionDetails: "Director and Scientific Member, Mainz",
                linkedin: "https://www.mpic.de/"
            },
            {
                name: "Prof. Guido Müller",
                previousInstitution: "University of Florida",
                specialization: "Physics & Gravitational Wave Detection",
                destination: "Germany",
                newInstitution: "Max Planck Institute for Gravitational Physics",
                newInstitutionDetails: "Director, Department of Precision Interferometry, Hannover",
                linkedin: "https://www.aei.mpg.de/"
            },

            // Other international destinations (8 scientists)
            {
                name: "Dr. Xiaoyu Song",
                previousInstitution: "Icahn School of Medicine at Mount Sinai",
                specialization: "Biostatistics & Quantitative Medicine",
                destination: "Singapore",
                newInstitution: "Duke-NUS Medical School",
                newInstitutionDetails: "Associate Professor, Centre for Quantitative Medicine",
                linkedin: "https://sites.google.com/view/xiaoyu-song/home"
            },
            {
                name: "Dr. Mathieu Francoeur",
                previousInstitution: "University of Utah",
                specialization: "Mechanical Engineering & Thermal Radiation",
                destination: "Canada",
                newInstitution: "McGill University",
                newInstitutionDetails: "Associate Professor, Faculty of Engineering",
                linkedin: "https://www.mcgill.ca/engineering/"
            },
            {
                name: "Dr. Anwar Hithnawi",
                previousInstitution: "UC Berkeley",
                specialization: "Data Privacy & Applied Cryptography",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Assistant Professor, Department of Computer Science",
                linkedin: "https://web.cs.toronto.edu/"
            },
            {
                name: "Dr. Yi Shouliang",
                previousInstitution: "US Department of Energy (National Energy Technology Laboratory)",
                specialization: "Carbon Capture & Utilization Technology",
                destination: "China",
                newInstitution: "Sichuan University",
                newInstitutionDetails: "Hai Na Distinguished Professor, Head of CCUS Innovation Team",
                linkedin: "https://www.scu.edu.cn/"
            },
            {
                name: "Dr. Sarah M. Kang",
                previousInstitution: "Princeton University (PhD), Columbia University (Postdoc)",
                specialization: "Climate Science & Atmospheric Dynamics",
                destination: "Germany",
                newInstitution: "Max Planck Institute for Meteorology",
                newInstitutionDetails: "Director, Department of Climate Dynamics, Hamburg",
                linkedin: "https://mpimet.mpg.de/"
            },
            {
                name: "Dr. Kuldeep Meel",
                previousInstitution: "Rice University (via NUS)",
                specialization: "Formal Methods & Artificial Intelligence",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Associate Professor, Department of Computer Science",
                linkedin: "https://web.cs.toronto.edu/"
            },
            {
                name: "Prof. Benjamin Sanderson",
                previousInstitution: "University of Colorado Boulder / NCAR",
                specialization: "Climate Science & Climate Modeling",
                destination: "France",
                newInstitution: "CNRS / Centre Européen de Recherche et de Formation Avancée en Calcul Scientifique",
                newInstitutionDetails: "Research Director, Climate Modeling Team",
                linkedin: "https://www.cerfacs.fr/"
            },
            {
                name: "Dr. Julia Kempe",
                previousInstitution: "New York University",
                specialization: "Machine Learning & Quantum Computing",
                destination: "France",
                newInstitution: "École Normale Supérieure",
                newInstitutionDetails: "Professor, Department of Computer Science, Paris",
                linkedin: "https://www.di.ens.fr/"
            },
            {
                name: "Prof. Steven Barrett",
                previousInstitution: "MIT",
                specialization: "Environmental Engineering",
                destination: "United Kingdom",
                newInstitution: "University of Cambridge",
                newInstitutionDetails: "Regius Professor of Engineering",
                linkedin: "https://www.linkedin.com/in/stevenrhbarrett"
            },
            {
                name: "Dr. Peter West",
                previousInstitution: "Stanford University",
                specialization: "Artificial Intelligence & Computer Science",
                destination: "Canada",
                newInstitution: "University of British Columbia",
                newInstitutionDetails: "Department of Computer Science",
                linkedin: "https://peterwestai.notion.site/"
            },
            {
                name: "Dr. Jane E",
                previousInstitution: "Stanford University", 
                specialization: "Artificial Intelligence & Computer Science",
                destination: "Singapore",
                newInstitution: "National University of Singapore",
                newInstitutionDetails: "Department of Computer Science",
                linkedin: "https://ejane.me/"
            },
            {
                name: "Prof. Tristan März",
                previousInstitution: "University of Michigan",
                specialization: "Biomedical Engineering",
                destination: "Switzerland", 
                newInstitution: "ETH Zurich",
                newInstitutionDetails: "Department of Health Sciences and Technology",
                linkedin: "https://www.linkedin.com/in/tristan-maerz-ph-d-57948711/"
            },
            {
                name: "Prof. Jason Stanley",
                previousInstitution: "Yale University",
                specialization: "Political Science & History",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Munk School of Global Affairs & Public Policy",
                linkedin: "https://substack.com/@jasonintrator"
            },
            {
                name: "Prof. Timothy Snyder",
                previousInstitution: "Yale University",
                specialization: "Political Science & History",
                destination: "Canada", 
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Munk School of Global Affairs & Public Policy",
                linkedin: "https://snyder.substack.com/"
            },
            {
                name: "Dr. Valerie Niemann",
                previousInstitution: "Stanford University",
                specialization: "Nanotechnology & Bioelectronics",
                destination: "Switzerland",
                newInstitution: "University of Bern",
                newInstitutionDetails: "Postdoctoral Researcher, Chemical Engineering",
                linkedin: "https://profiles.stanford.edu/valerie-niemann"
            },
            {
                name: "Prof. Matthias Doepke",
                previousInstitution: "Northwestern University",
                specialization: "Economics",
                destination: "United Kingdom",
                newInstitution: "London School of Economics",
                newInstitutionDetails: "Economics Department, Full-time Position",
                linkedin: "https://economics.northwestern.edu/people/directory/matthias-doepke.html"
            },
            {
                name: "Prof. Marci Shore",
                previousInstitution: "Yale University",
                specialization: "Political Science & History",
                destination: "Canada",
                newInstitution: "University of Toronto",
                newInstitutionDetails: "Munk School of Global Affairs & Public Policy",
                linkedin: "https://x.com/marci_shore"
            }
        ];

        let filteredScientists = [...allScientists];
        let currentSort = { column: null, direction: 'asc' };

        function updateStatistics() {
            // Calculate destination counts
            const destinationCounts = {};
            allScientists.forEach(scientist => {
                destinationCounts[scientist.destination] = (destinationCounts[scientist.destination] || 0) + 1;
            });

            // Find top destination
            const topDestination = Object.keys(destinationCounts).reduce((a, b) => 
                destinationCounts[a] > destinationCounts[b] ? a : b
            );

            // Update statistics
            document.getElementById('totalScientists').textContent = allScientists.length;
            document.getElementById('topDestination').textContent = `${topDestination} (${destinationCounts[topDestination]})`;
            document.getElementById('uniqueDestinations').textContent = Object.keys(destinationCounts).length;
        }

        function sortTable(columnIndex, dataKey) {
            if (currentSort.column === columnIndex) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.direction = 'asc';
            }
            currentSort.column = columnIndex;

            filteredScientists.sort((a, b) => {
                let valueA = a[dataKey] || '';
                let valueB = b[dataKey] || '';

                if (typeof valueA === 'string') valueA = valueA.toLowerCase();
                if (typeof valueB === 'string') valueB = valueB.toLowerCase();

                if (currentSort.direction === 'asc') {
                    return valueA < valueB ? -1 : valueA > valueB ? 1 : 0;
                } else {
                    return valueA > valueB ? -1 : valueA < valueB ? 1 : 0;
                }
            });

            updateSortIndicators();
            updateTable();
        }

        function updateSortIndicators() {
            document.querySelectorAll('.sort-icon').forEach(icon => {
                icon.classList.remove('active');
                icon.textContent = '▲▼';
            });

            if (currentSort.column !== null) {
                const activeIcon = document.querySelectorAll('.sort-icon')[currentSort.column];
                activeIcon.classList.add('active');
                activeIcon.textContent = currentSort.direction === 'asc' ? '▲' : '▼';
            }
        }

        function updateTable() {
            const tbody = document.getElementById('scientistsTableBody');
            const resultsInfo = document.getElementById('resultsInfo');
            
            if (filteredScientists.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="no-data">No records match the current filter criteria</td></tr>';
                resultsInfo.textContent = 'Showing 0 of ' + allScientists.length + ' records';
                return;
            }

            tbody.innerHTML = filteredScientists.map(scientist => {
                const newInstitutionDisplay = scientist.newInstitution ? 
                    `<div class="institution-line1">${scientist.newInstitution}</div>
                     ${scientist.newInstitutionDetails ? `<div class="institution-line2">${scientist.newInstitutionDetails}</div>` : ''}` :
                    'Not specified';

                return `
                    <tr>
                        <td class="scientist-name">${scientist.name}</td>
                        <td class="institution">${scientist.previousInstitution}</td>
                        <td class="specialization">${scientist.specialization}</td>
                        <td class="destination">${scientist.destination}</td>
                        <td class="institution">${newInstitutionDisplay}</td>
                        <td>${scientist.linkedin ? 
                            `<a href="${scientist.linkedin}" class="linkedin-link" target="_blank">View Profile</a>` : 
                            'Not provided'
                        }</td>
                    </tr>
                `;
            }).join('');

            resultsInfo.textContent = `Showing ${filteredScientists.length} of ${allScientists.length} records`;
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const specialtyFilter = document.getElementById('specialtyFilter').value;
            const destinationFilter = document.getElementById('destinationFilter').value;

            filteredScientists = allScientists.filter(scientist => {
                const matchesSearch = !searchTerm || 
                    scientist.name.toLowerCase().includes(searchTerm) ||
                    scientist.previousInstitution.toLowerCase().includes(searchTerm) ||
                    scientist.specialization.toLowerCase().includes(searchTerm) ||
                    scientist.destination.toLowerCase().includes(searchTerm) ||
                    (scientist.newInstitution && scientist.newInstitution.toLowerCase().includes(searchTerm));

                const matchesSpecialty = !specialtyFilter || scientist.specialization === specialtyFilter;
                const matchesDestination = !destinationFilter || scientist.destination === destinationFilter;

                return matchesSearch && matchesSpecialty && matchesDestination;
            });

            updateTable();
        }

        function updateFilters() {
            // Update specialty filter
            const specialtyFilter = document.getElementById('specialtyFilter');
            const specialties = [...new Set(allScientists.map(s => s.specialization))].sort();
            const currentSpecialty = specialtyFilter.value;
            
            specialtyFilter.innerHTML = '<option value="">All Specialties</option>';
            specialties.forEach(specialty => {
                const option = document.createElement('option');
                option.value = specialty;
                option.textContent = specialty;
                specialtyFilter.appendChild(option);
            });
            specialtyFilter.value = currentSpecialty;

            // Update destination filter
            const destinationFilter = document.getElementById('destinationFilter');
            const destinations = [...new Set(allScientists.map(s => s.destination))].sort();
            const currentDestination = destinationFilter.value;
            
            destinationFilter.innerHTML = '<option value="">All Countries</option>';
            destinations.forEach(destination => {
                const option = document.createElement('option');
                option.value = destination;
                option.textContent = destination;
                destinationFilter.appendChild(option);
            });
            destinationFilter.value = currentDestination;
        }

        function openModal() {
            document.getElementById('scientistModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('scientistModal').style.display = 'none';
            // Clear form
            document.getElementById('name').value = '';
            document.getElementById('linkedin').value = '';
            document.getElementById('previousInstitution').value = '';
            document.getElementById('specialization').value = '';
            document.getElementById('destination').value = '';
            document.getElementById('newInstitution').value = '';
        }

        function addScientist() {
            const name = document.getElementById('name').value.trim();
            const previousInstitution = document.getElementById('previousInstitution').value.trim();
            const specialization = document.getElementById('specialization').value.trim();
            const destination = document.getElementById('destination').value.trim();
            const newInstitution = document.getElementById('newInstitution').value.trim();
            const linkedin = document.getElementById('linkedin').value.trim();

            if (!name || !previousInstitution || !specialization || !destination) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }

            const newScientist = {
                name,
                previousInstitution,
                specialization,
                destination,
                newInstitution,
                newInstitutionDetails: '',
                linkedin
            };

            allScientists.unshift(newScientist);
            
            updateFilters();
            updateStatistics();
            applyFilters();
            closeModal();
        }

        function exportToCSV() {
            const headers = ['Name', 'Previous Institution', 'Specialization', 'Destination', 'New Institution', 'Profile Link'];
            
            let csvContent = headers.join(',') + '\n';
            
            const dataToExport = filteredScientists.length > 0 ? filteredScientists : allScientists;
            
            dataToExport.forEach(scientist => {
                const newInst = scientist.newInstitution ? 
                    `${scientist.newInstitution}${scientist.newInstitutionDetails ? ' - ' + scientist.newInstitutionDetails : ''}` :
                    'Not specified';
                    
                const row = [
                    `"${scientist.name}"`,
                    `"${scientist.previousInstitution}"`,
                    `"${scientist.specialization}"`,
                    `"${scientist.destination}"`,
                    `"${newInst}"`,
                    `"${scientist.linkedin || 'Not provided'}"`
                ];
                csvContent += row.join(',') + '\n';
            });
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `scientist-migration-data-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function exportToJSON() {
            const dataToExport = filteredScientists.length > 0 ? filteredScientists : allScientists;
            
            const exportData = {
                exportDate: new Date().toISOString(),
                totalRecords: dataToExport.length,
                filters: {
                    search: document.getElementById('searchInput').value || null,
                    specialty: document.getElementById('specialtyFilter').value || null,
                    destination: document.getElementById('destinationFilter').value || null
                },
                data: dataToExport
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `scientist-migration-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('specialtyFilter').addEventListener('change', applyFilters);
        document.getElementById('destinationFilter').addEventListener('change', applyFilters);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('scientistModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize the application
        function initializeApp() {
            updateFilters();
            updateStatistics();
            updateTable();
        }

        // Run initialization when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>